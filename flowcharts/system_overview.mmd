graph TB
    Start([‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô]) --> SelectProfile[‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Profile ‡∏™‡∏≤‡∏£<br/>Phosphate/Nitrate/Ammonia]
    SelectProfile --> Choice{‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î}
    
    Choice -->|‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•| Collect[üìä ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•]
    Choice -->|‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•| Train[ü§ñ ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•]
    Choice -->|‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ú‡∏•| Predict[üîÆ ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ú‡∏•]
    
    Collect --> Upload1[‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û]
    Upload1 --> SetROI1[‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ROI<br/>‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á]
    SetROI1 --> ExtractRGB1[‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ RGB ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢<br/>‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ROI]
    ExtractRGB1 --> InputConc[‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô‡∏à‡∏£‡∏¥‡∏á]
    InputConc --> SaveData[‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á CSV<br/>profile_dataset.csv]
    SaveData --> MoreData{‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•<br/>‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°?}
    MoreData -->|‡πÉ‡∏ä‡πà| Upload1
    MoreData -->|‡πÑ‡∏°‡πà| End1([‡∏à‡∏ö])
    
    Train --> CheckData{‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•<br/>‚â• 5 ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á?}
    CheckData -->|‡πÑ‡∏°‡πà| Error1[‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:<br/>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠]
    Error1 --> End2([‡∏à‡∏ö])
    CheckData -->|‡πÉ‡∏ä‡πà| LoadData[‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å CSV]
    LoadData --> PrepareData[‡πÅ‡∏¢‡∏Å Features X, Y<br/>X = R,G,B<br/>Y = Concentration]
    PrepareData --> TrainModel[‡πÄ‡∏ó‡∏£‡∏ô Random Forest<br/>Regressor Model]
    TrainModel --> CalcR2[‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì R¬≤ Score]
    CalcR2 --> SaveModel[‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Model<br/>profile_model.joblib]
    SaveModel --> ShowResult[‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• R¬≤ Score<br/>‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥]
    ShowResult --> End3([‡∏à‡∏ö])
    
    Predict --> CheckModel{‡∏°‡∏µ Model<br/>‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡∏£‡∏ô‡πÅ‡∏•‡πâ‡∏ß?}
    CheckModel -->|‡πÑ‡∏°‡πà| Error2[‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:<br/>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Å‡πà‡∏≠‡∏ô]
    Error2 --> End4([‡∏à‡∏ö])
    CheckModel -->|‡πÉ‡∏ä‡πà| Upload2[‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏°‡πà]
    Upload2 --> SetROI2[‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ROI<br/>‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á]
    SetROI2 --> ExtractRGB2[‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ RGB ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢<br/>‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ROI]
    ExtractRGB2 --> LoadModel[‡πÇ‡∏´‡∏•‡∏î Model]
    LoadModel --> PredictConc[‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô<br/>‡∏à‡∏≤‡∏Å RGB]
    PredictConc --> ShowPrediction[‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢<br/>‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢]
    ShowPrediction --> End5([‡∏à‡∏ö])
    
    style Start fill:#90EE90
    style End1 fill:#FFB6C1
    style End2 fill:#FFB6C1
    style End3 fill:#FFB6C1
    style End4 fill:#FFB6C1
    style End5 fill:#FFB6C1
    style Collect fill:#87CEEB
    style Train fill:#FFD700
    style Predict fill:#DDA0DD
